name: "Second action"
on:
  workflow_run:
    workflows: ["First action"]
    types: [completed]
    branches:
      - main

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Download a single artifact
        uses: dawidd6/action-download-artifact@v2
        id: download
        with:
          workflow: first-action.yml
          name: ref-base
          workflow_conclusion: success
      - shell: bash
        run: |
          ls -la
          REF_BASE=`cat ref-base.txt`
          echo "REF_BASE=$REF_BASE" >> $GITHUB_ENV
          echo '${{ toJSON(steps.download.outputs.artifacts) }}'
          echo '${{ env.REF_BASE }}'
      - uses: dorny/paths-filter@v2
        id: filter
        with:
          base: ${{ env.REF_BASE }}
          filters: |
            src:
              - src/**
            lib:
              - lib/**
      - name: check
        run: |
          echo '${{ toJSON(steps.filter.outputs) }}'
